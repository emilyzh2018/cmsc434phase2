<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=640, initial-scale=1.0" />
  <title>Health Tracking</title>
  <link href="https://fonts.googleapis.com/css?family=Inter" rel="stylesheet" />
  <link rel="stylesheet" href="healthTracker.css" />
</head>
<body>
  <div class="device">
    <div class="main-content" id="main-content">
      <div id="title-bar">
        <h1>Health Tracking</h1>
      </div>

      <div id="color-block">
        <strong>Workout Routine of the Day: <span id="routine-title-display">None Selected</span></strong>

        <button class="small-btn" id="edit-routine-btn">Edit</button>
        <ul id="routine-list">
          
         
        </ul>
        <button class="small-btn" id="clear-routine-btn">Clear Routine</button>

      </div>

      <div id="daily-tip-box">
        <div id="goals-section">
          <p><strong>Goals Progress</strong> <button id="add-goal-btn" class="small-btn">+</button></p>
          <div id="goals-list"></div>
        </div>
        
    
        <div class="modal" id="goal-modal">
          <div class="modal-content">
            <span class="close-btn" id="close-goal-modal">Ã—</span>
            <h3 id="goal-modal-title">Add New Goal</h3>
            <input type="text" id="goal-title" placeholder="Goal Title" />
            <select id="goal-category">
              <option value="">Select Category</option>
              <option value="Cardio">Cardio</option>
              <option value="Weightlifting">Weightlifting</option>
            </select>
            
            <input type="number" id="goal-target" placeholder="Target Value" />
            <input type="date" id="goal-start-date" />
            <input type="date" id="goal-end-date" />
            <button class="small-btn" id="save-goal">Save Goal</button>
          </div>
        </div>
       
        <div class="modal" id="progress-modal">
          <div class="modal-content">
            <span class="close-btn" id="close-progress-modal">Ã—</span>
            <h3>Update Progress</h3>
            <input type="number" id="progress-input" placeholder="Enter progress value" />
            <button class="small-btn" id="submit-progress">Submit</button>
            <button class="delete-btn" id="delete-goal-btn">Delete Goal</button> 
          </div>
        </div>
        

        
      </div>

      <div class="button-row">
        <div class="button-with-plus">
          <button class="gallery-item" id="open-pr-modal">Workout Personal Records</button>
          <button class="add-btn-large" id="add-pr-btn">+</button>
        </div>
        <button class="gallery-item" id="open-trends-modal">Trends</button>
      </div>
    </div>

    <div class="modal" id="pr-modal">
      <div class="modal-content">
        <span class="close-btn" id="close-pr-modal">Ã—</span>
        <h3>Workout Personal Records</h3>
        <div class="gallery-content" id="pr-gallery">
         
        </div>
      </div>
    </div>

    <div class="modal" id="trends-modal">
      <div class="modal-content">
        <span class="close-btn" id="close-trends-modal">Ã—</span>
        <h3>Trends</h3>
        <div class="gallery-content" id="trends-gallery">
          <div class="gallery-item">Mile Pace<br><img src="images/mile_pace_trend.png" alt="mile graph" /></div>
          <div class="gallery-item">Steps<br><img src="images/steps_trend.png" alt="steps graph" /></div>
        </div>
      </div>
    </div>

    <div class="modal" id="pr-input-modal">
      <div class="modal-content">
        <span class="close-btn" id="close-pr-input-modal">Ã—</span>
        <h3>Add New Personal Record</h3>
        <div class="input-form">
          <input type="text" id="pr-exercise" placeholder="Exercise" />
          <input type="text" id="pr-value" placeholder="Value" />
          <button class="small-btn" id="submit-pr">Submit</button>
        </div>
      </div>
    </div>

    <div class="modal" id="routine-modal">
      <div class="modal-content">
        <span class="close-btn" id="close-routine-modal">Ã—</span>
        <h3>Create/Edit Workout Routine</h3>
        <div class="input-form">
          <input type="text" id="routine-name" placeholder="Routine Name" />
          <div id="current-exercises-list">

          </div>
           
          <button class="small-btn" id="add-exercise-btn">Add Exercise</button>
          <div id="inline-add-exercise-form" class="input-form">
            <input type="text" id="inline-exercise-name" placeholder="Exercise" />
            <input type="text" id="inline-exercise-sets" placeholder="Sets (e.g., 3 sets)" />
            <button class="small-btn" id="inline-submit-exercise">Add Exercise</button>
          </div>
          
          <button class="small-btn" id="save-routine-btn">Save Routine</button>
        </div>

        <h3 style="margin-top: 20px;">Past Routines</h3>
        <div id="past-routines">
         
        </div>
      </div>
    </div>

    <div class="modal" id="exercise-input-modal">
      <div class="modal-content">
        <span class="close-btn" id="close-exercise-input-modal">Ã—</span>
        <h3>Add Exercise</h3>
        <div class="input-form">
          <input type="text" id="exercise-name" placeholder="Exercise" />
          <input type="text" id="exercise-sets" placeholder="Sets (e.g., 3 sets)" />
          <button class="small-btn" id="submit-exercise">Submit</button>
        </div>
      </div>
    </div>


    

    <div class="modal" id="edit-routine-modal">
      <div class="modal-content">
        <span class="close-btn" id="close-edit-routine-modal">Ã—</span>
        <h3>Edit Routine</h3>
        <div class="input-form">
          <input type="text" id="edit-routine-name" placeholder="Routine Name" />
          <h4>Exercises</h4>
          <div id="edit-exercises-list"></div>
          <button class="small-btn" id="edit-add-exercise-btn">Add Exercise</button>
          <button class="small-btn" id="save-edited-routine-btn">Save Changes</button>
          <button class="small-btn apply-btn" id="apply-edited-routine-btn">Apply Routine</button>
        </div>
      </div>
    </div>

    <div class="modal" id="goal-achieved-modal">
      <div class="modal-content">
        <h3>ðŸŽ‰ You met your goal!</h3>
        <button class="small-btn" id="close-goal-achieved">close</button>
      </div>
    </div>
    
    <div class="bottom-nav">
      <div class="nav-item">
        <a href="insights.html">
        <img src="images/insight.png" alt="Insight Icon" class="icon" />
        <span class="label">Insights</span>
        </a>
      </div>
      <div class="nav-item active">
        <a id="nav-item-active" href="healthTracker.html">
        <img src="images/watch-fitness.png" alt="Fitness Icon" class="icon" />
        <span class="label">Fitness</span>
      </a>
      </div>
      <div class="nav-item">
        <a href="index.html">
          <img src="images/home.png" alt="Home Icon" class="icon" />
          <span class="label">Home</span>
        </a>
      </div>
      <div class="nav-item">
        <a href="Nutrition_Style.html">
        <img src="images/apple-whole.png" alt="Nutrition Icon" class="icon" />
        <span class="label">Nutrition</span>
        </a>
      </div>
      <div class="nav-item">
        <a href="profile.html">
        <img src="images/profile.png" alt="Profile Icon" class="icon" />
        <span class="label">Profile</span>
      </a>
      </div>
    </div>
  </div>

  <script>
    let personalRecords = JSON.parse(localStorage.getItem("personalRecords")) || [];

    function savePRs() {
      localStorage.setItem("personalRecords", JSON.stringify(personalRecords));
    }


    const body = document.body;
    let isEditingRoutine = false;

    const prModal = document.getElementById("pr-modal");
    const openPR = document.getElementById("open-pr-modal");
    const closePR = document.getElementById("close-pr-modal");
    const trendsModal = document.getElementById("trends-modal");
    const openTrends = document.getElementById("open-trends-modal");
    const closeTrends = document.getElementById("close-trends-modal");
    const prInputModal = document.getElementById("pr-input-modal");
    const addPRBtn = document.getElementById("add-pr-btn");
    const closePRInput = document.getElementById("close-pr-input-modal");
    const submitPR = document.getElementById("submit-pr");
    const prGallery = document.getElementById("pr-gallery");
    const mainContent = document.getElementById('main-content');
    const routineModal = document.getElementById("routine-modal");
    const closeRoutineModal = document.getElementById("close-routine-modal");
    const addExerciseBtn = document.getElementById("add-exercise-btn");
    const saveRoutineBtn = document.getElementById("save-routine-btn");
    const routineNameInput = document.getElementById("routine-name");
    const pastRoutinesDiv = document.getElementById("past-routines");
    const exerciseInputModal = document.getElementById("exercise-input-modal");
    const closeExerciseInputModal = document.getElementById("close-exercise-input-modal");
    const submitExerciseBtn = document.getElementById("submit-exercise");
    const editRoutineBtn = document.getElementById("edit-routine-btn");
    const routineList = document.getElementById("routine-list");
    const editRoutineModal = document.getElementById("edit-routine-modal");
    const closeEditRoutineModal = document.getElementById("close-edit-routine-modal");
    const editRoutineNameInput = document.getElementById("edit-routine-name");
    const editExercisesList = document.getElementById("edit-exercises-list");
    const editAddExerciseBtn = document.getElementById("edit-add-exercise-btn");
    const saveEditedRoutineBtn = document.getElementById("save-edited-routine-btn");
    const applyEditedRoutineBtn = document.getElementById("apply-edited-routine-btn");
    const currentExercisesList = document.getElementById("current-exercises-list");

    //load the workout routine based on day of week
    function loadTodayRoutineFromProfile() {
  const days = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
  const today = days[new Date().getDay()];
  const routineData = JSON.parse(localStorage.getItem(`profileInfo${today}`));

  if (routineData) {
    const titleSpan = document.getElementById("routine-title-display");
    titleSpan.textContent = `${routineData.activity}`;


    routineList.innerHTML = `<li><input type="checkbox" /> ${routineData.activity}</li>`;
  }
}

document.addEventListener("DOMContentLoaded", () => {
  loadTodayRoutineFromProfile();
});
const clearRoutineBtn = document.getElementById("clear-routine-btn");

clearRoutineBtn.addEventListener("click", () => {
  localStorage.removeItem("currentRoutine");
  document.getElementById("routine-title-display").textContent = "None Selected";
  routineList.innerHTML = "";
});


    document.addEventListener("DOMContentLoaded", () => {

      const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
      const today = new Date();
      const dayName = days[today.getDay()];

      const savedRoutineJson = localStorage.getItem(`profileInfo${dayName}`);
      console.log(savedRoutineJson);

      let savedRoutine = JSON.parse(savedRoutineJson);

      console.log(savedRoutine);

      if (savedRoutine) {
        routineList.innerHTML = "";
        
      }

      // routine.exercises.forEach((ex) => {
      // const li = document.createElement("li");
      // li.innerHTML = `<input type="checkbox" /> ${ex.exercise} - ${ex.sets}`;
      // routineList.appendChild(li);
      // });
    });

    function openModal(modal) {
      modal.style.display = "block";
      mainContent.classList.add("dimmed");
    }

    function closeModal(modal) {
      modal.style.display = "none";
      mainContent.classList.remove("dimmed");
    }

   
    openPR.onclick = () => {
  renderPRs();
  openModal(prModal);
};

    closePR.onclick = () => closeModal(prModal);
    openTrends.onclick = () => openModal(trendsModal);
    closeTrends.onclick = () => closeModal(trendsModal);
    addPRBtn.onclick = () => openModal(prInputModal);
    closePRInput.onclick = () => closeModal(prInputModal);

    window.onclick = (event) => {
      if (event.target === prModal) closeModal(prModal);
      if (event.target === trendsModal) closeModal(trendsModal);
      if (event.target === prInputModal) closeModal(prInputModal);
      if (event.target === routineModal) closeModal(routineModal);
      if (event.target === exerciseInputModal) closeModal(exerciseInputModal);
      if (event.target === editRoutineModal) closeModal(editRoutineModal);
    };
    
    function renderPRs() {
  prGallery.innerHTML = "";
  personalRecords.forEach((pr, index) => {
    const prDiv = document.createElement("div");
    prDiv.className = "gallery-item";
    prDiv.innerHTML = `
      <div class="pr-entry">
        ${pr.exercise}<br><strong>${pr.value}</strong>
        <button class="small-btn delete-pr" data-index="${index}">x</button>
      </div>
    `;
    prGallery.appendChild(prDiv);
  });

  //delete handler
  document.querySelectorAll(".delete-pr").forEach(btn => {
    btn.addEventListener("click", (e) => {
      const index = e.target.getAttribute("data-index");
      personalRecords.splice(index, 1);
      savePRs();
      renderPRs();

    });
  });
}


submitPR.onclick = () => {
  const exercise = document.getElementById("pr-exercise").value;
  const value = document.getElementById("pr-value").value;
  if (exercise && value) {
    personalRecords.push({ exercise, value });
    savePRs(); //Save it to localStorage!
    document.getElementById("pr-exercise").value = "";
    document.getElementById("pr-value").value = "";
    closeModal(prInputModal);
    renderPRs();
  }
};




let pastRoutines = JSON.parse(localStorage.getItem("pastRoutines")) || [];

    let currentRoutine = { name: "", exercises: [] };
    let selectedRoutineIndex = null;

    function renderPastRoutines() {
  pastRoutinesDiv.innerHTML = "";

  pastRoutines.forEach((routine, index) => {
    const routineDiv = document.createElement("div");
    routineDiv.className = "past-routine-item";
    routineDiv.innerHTML = `
      <span>${routine.name}</span>
      <button class="small-btn apply-btn" data-index="${index}">Select</button>
      <button class="small-btn edit-btn" data-index="${index}">Edit</button>
      <button class="delete-btn" data-index="${index}">Delete</button>
    `;

    pastRoutinesDiv.appendChild(routineDiv); 
  });

  
  document.querySelectorAll(".edit-btn").forEach((btn) => {
    btn.addEventListener("click", (e) => {
      const index = e.target.getAttribute("data-index");
      openEditRoutineModal(index);
    });
  });

  document.querySelectorAll(".apply-btn").forEach((btn) => {
    btn.addEventListener("click", (e) => {
      const index = e.target.getAttribute("data-index");
      const routine = pastRoutines[index];
      applyRoutine(routine); 
    });
  });

  document.querySelectorAll(".delete-btn").forEach((btn) => {
    btn.addEventListener("click", (e) => {
      const index = e.target.getAttribute("data-index");
      deleteRoutine(index);
    });
  });
}


    function openEditRoutineModal(index) {
      selectedRoutineIndex = index;
      const routine = pastRoutines[index];
      editRoutineNameInput.value = routine.name;
      renderEditExercises(routine.exercises);
      openModal(editRoutineModal);
    }

    function renderEditExercises(exercises) {
      editExercisesList.innerHTML = "";
      exercises.forEach((ex, idx) => {
        const exerciseDiv = document.createElement("div");
        exerciseDiv.className = "exercise-item";
        exerciseDiv.innerHTML = `
          <span>${ex.exercise} - ${ex.sets}</span>
          <button class="delete-btn" data-exercise-index="${idx}">Delete</button>
        `;
        editExercisesList.appendChild(exerciseDiv);
      });

      document.querySelectorAll("#edit-exercises-list .delete-btn").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          const exerciseIndex = e.target.getAttribute("data-exercise-index");
          pastRoutines[selectedRoutineIndex].exercises.splice(exerciseIndex, 1);
          renderEditExercises(pastRoutines[selectedRoutineIndex].exercises);
        });
      });
    }

    function renderCurrentExercises() {
      currentExercisesList.innerHTML = "";
      if (currentRoutine.exercises.length > 0) {
        const exercisesHeader = document.createElement("h4");
        exercisesHeader.textContent = "Exercises";
        currentExercisesList.appendChild(exercisesHeader);

        currentRoutine.exercises.forEach((ex, idx) => {
          const exerciseDiv = document.createElement("div");
          exerciseDiv.className = "exercise-item";
          exerciseDiv.innerHTML = `
            <span>${ex.exercise} - ${ex.sets}</span>
            <button class="delete-btn" data-exercise-index="${idx}">Delete</button>
          `;
          currentExercisesList.appendChild(exerciseDiv);
        });

        document.querySelectorAll("#current-exercises-list .delete-btn").forEach((btn) => {
          btn.addEventListener("click", (e) => {
            const exerciseIndex = e.target.getAttribute("data-exercise-index");
            currentRoutine.exercises.splice(exerciseIndex, 1);
            renderCurrentExercises();
          });
        });
      }
    }

    function applyRoutine(routine) {

      const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

      const today = new Date();
      const dayName = days[today.getDay()];


      console.log(localStorage.getItem(`profileInfo${dayName}`));


  routineList.innerHTML = "";
  routine.exercises.forEach((ex) => {
    const li = document.createElement("li");
    li.innerHTML = `<input type="checkbox" /> ${ex.exercise} - ${ex.sets}`;
    routineList.appendChild(li);
  });
  localStorage.setItem("currentRoutine", JSON.stringify(routine)); 
  closeModal(editRoutineModal);
  closeModal(routineModal);
}


function deleteRoutine(index) {
  pastRoutines.splice(index, 1);
  localStorage.setItem("pastRoutines", JSON.stringify(pastRoutines)); 
  renderPastRoutines();
}


    editRoutineBtn.addEventListener("click", () => {
      openModal(routineModal);
    });

    closeRoutineModal.addEventListener("click", () => {
      closeModal(routineModal);
      currentRoutine = { name: "", exercises: [] };
      routineNameInput.value = "";
      renderCurrentExercises(); 
    });

    // addExerciseBtn.addEventListener("click", () => {
    //   isEditingRoutine = false;
    //   exerciseInputModal.classList.remove("on-top"); 
    //   openModal(exerciseInputModal);
    // });
    addExerciseBtn.addEventListener("click", () => {
  document.getElementById("inline-add-exercise-form").style.display = "block";
  addExerciseBtn.style.display = "none"; //hide button
});




    closeExerciseInputModal.addEventListener("click", () => {
  exerciseInputModal.classList.remove("on-top");
  closeModal(exerciseInputModal);
});
document.getElementById("inline-submit-exercise").addEventListener("click", () => {
  const exercise = document.getElementById("inline-exercise-name").value;
  const sets = document.getElementById("inline-exercise-sets").value;
  if (exercise && sets) {
    currentRoutine.exercises.push({ exercise, sets });
    renderCurrentExercises();
    document.getElementById("inline-exercise-name").value = "";
    document.getElementById("inline-exercise-sets").value = "";
    document.getElementById("inline-add-exercise-form").style.display = "none";
    document.getElementById("inline-add-exercise-form").style.display = "none";
    addExerciseBtn.style.display = "block"; //show the button again
  }
});



    submitExerciseBtn.addEventListener("click", () => {
  const exercise = document.getElementById("exercise-name").value;
  const sets = document.getElementById("exercise-sets").value;
  if (exercise && sets) {
    if (isEditingRoutine) {
      pastRoutines[selectedRoutineIndex].exercises.push({ exercise, sets });
      renderEditExercises(pastRoutines[selectedRoutineIndex].exercises);
    } else {
      currentRoutine.exercises.push({ exercise, sets });
      renderCurrentExercises();
    }
    document.getElementById("exercise-name").value = "";
    document.getElementById("exercise-sets").value = "";
    closeModal(exerciseInputModal);
  }
});

    saveRoutineBtn.addEventListener("click", () => {
  const routineName = routineNameInput.value;
  if (routineName && currentRoutine.exercises.length > 0) {
    pastRoutines.push({ name: routineName, exercises: [...currentRoutine.exercises] });
    localStorage.setItem("pastRoutines", JSON.stringify(pastRoutines)); 
    currentRoutine = { name: "", exercises: [] };
    routineNameInput.value = "";
    renderCurrentExercises(); 
    renderPastRoutines();
  }
});


    closeEditRoutineModal.addEventListener("click", () => {
      closeModal(editRoutineModal);
      selectedRoutineIndex = null;
    });

    editAddExerciseBtn.addEventListener("click", () => {

      isEditingRoutine = true; //We're editing
      exerciseInputModal.classList.add("on-top"); //raise z-index

      openModal(exerciseInputModal);
     
    });

    saveEditedRoutineBtn.addEventListener("click", () => {
      const newName = editRoutineNameInput.value;
      if (newName) {

        pastRoutines[selectedRoutineIndex].name = newName;
        renderPastRoutines();
        closeModal(editRoutineModal);
      }
      localStorage.setItem("pastRoutines", JSON.stringify(pastRoutines));

    });

    applyEditedRoutineBtn.addEventListener("click", () => {
      const routine = pastRoutines[selectedRoutineIndex];
      applyRoutine(routine);
    });

    renderPastRoutines();

const savedRoutine = JSON.parse(localStorage.getItem("currentRoutine"));
if (savedRoutine) {
  applyRoutine(savedRoutine);
}

    const goalsList = document.getElementById("goals-list");
  const addGoalBtn = document.getElementById("add-goal-btn");
  const goalModal = document.getElementById("goal-modal");
  const closeGoalModal = document.getElementById("close-goal-modal");
  const saveGoalBtn = document.getElementById("save-goal");

  const goalTitle = document.getElementById("goal-title");
  const goalCategory = document.getElementById("goal-category");
  const goalTarget = document.getElementById("goal-target");
  const goalStartDate = document.getElementById("goal-start-date");
  const goalEndDate = document.getElementById("goal-end-date");

  let goals = JSON.parse(localStorage.getItem("goals")) || [];
  let editingGoalIndex = null;

  function renderGoals() {
  goalsList.innerHTML = "";
  goals.forEach((goal, index) => {
    const div = document.createElement("div");
    div.className = "goal-item";

    // Goal title and edit button
    let html = `
      <div class="goal-title">
        ${goal.title}
        <button class="edit-goal-btn small-btn" data-index="${index}" style="margin-left: 8px;">Edit</button>
      </div>
    `;

    // Different display based on category
    if (goal.category === "Weightlifting") {
      const checked = goal.progress >= 1 ? "checked" : "";
      html = `
  <div class="goal-checkbox-line">
    <label>
      <input type="checkbox" ${checked} data-index="${index}" class="goal-checkbox" />
      ${goal.title}
    </label>
    <button class="edit-goal-btn small-btn" data-index="${index}">Edit</button>
  </div>
`;

    } else {
      html += `
        <progress class="goal-progress" value="${goal.progress || 0}" max="${goal.target}"></progress>
      `;
    }

    div.innerHTML = html;

    // Click to update (only for non-weightlifting)
    if (goal.category !== "Weightlifting") {
      div.onclick = () => updateGoalProgress(index);
    }

    goalsList.appendChild(div);
  });

  // Edit goal event listeners
  document.querySelectorAll(".edit-goal-btn").forEach(btn => {
    btn.addEventListener("click", (e) => {
      e.stopPropagation();
      const index = parseInt(btn.getAttribute("data-index"));
      openEditGoalModal(index);
    });
  });

  // Checkbox handler for weightlifting goals
  document.querySelectorAll(".goal-checkbox").forEach(cb => {
    cb.addEventListener("change", (e) => {
      const index = parseInt(e.target.getAttribute("data-index"));
      goals[index].progress = e.target.checked ? 1 : 0;

      if (goals[index].progress >= 1) {
        document.getElementById("goal-achieved-modal").style.display = "block";
        goals.splice(index, 1); // Remove completed
      }

      localStorage.setItem("goals", JSON.stringify(goals));
      renderGoals();
    });
  });
}



  let progressModal = document.getElementById("progress-modal");
let progressInput = document.getElementById("progress-input");
let closeProgressModal = document.getElementById("close-progress-modal");
let submitProgressBtn = document.getElementById("submit-progress");

let currentGoalIndex = null;

function updateGoalProgress(index) {
  currentGoalIndex = index;
  progressInput.value = "";
  progressModal.style.display = "block";
}

submitProgressBtn.onclick = () => {
  const value = parseFloat(progressInput.value);
  if (!isNaN(value)) {
    goals[currentGoalIndex].progress = Math.min(
      (goals[currentGoalIndex].progress || 0) + value,
      goals[currentGoalIndex].target
    );

    if (goals[currentGoalIndex].progress >= goals[currentGoalIndex].target) {
      //celebration modal
      document.getElementById("goal-achieved-modal").style.display = "block";

      //delete the goal
      goals.splice(currentGoalIndex, 1);
      localStorage.setItem("goals", JSON.stringify(goals));
      renderGoals();
      progressModal.style.display = "none";
    } else {
      localStorage.setItem("goals", JSON.stringify(goals));
      renderGoals();
      progressModal.style.display = "none";
    }
  }
};

document.getElementById("close-goal-achieved").onclick = () => {
  document.getElementById("goal-achieved-modal").style.display = "none";
};


closeProgressModal.onclick = () => {
  progressModal.style.display = "none";
};

window.onclick = (event) => {
  if (event.target === progressModal) {
    progressModal.style.display = "none";
  }
};
const deleteGoalBtn = document.getElementById("delete-goal-btn");

deleteGoalBtn.onclick = () => {
  if (currentGoalIndex !== null) {
    goals.splice(currentGoalIndex, 1);
    localStorage.setItem("goals", JSON.stringify(goals));
    renderGoals();
    progressModal.style.display = "none";
  }
};



  function openGoalModal() {
    goalTitle.value = "";
    goalCategory.value = "";
    goalTarget.value = "";
    goalStartDate.value = "";
    goalEndDate.value = "";
    editingGoalIndex = null;
    goalModal.style.display = "block";
  }
  function openEditGoalModal(index) {
  const goal = goals[index];
  goalTitle.value = goal.title;
  goalCategory.value = goal.category;
  goalTarget.value = goal.target;
  goalStartDate.value = goal.start;
  goalEndDate.value = goal.end;
  editingGoalIndex = index;

  goalModal.style.display = "block";
}


  function closeGoalForm() {
    goalModal.style.display = "none";
  }

  saveGoalBtn.onclick = () => {
    const newGoal = {
      title: goalTitle.value,
      category: goalCategory.value,
      target: parseFloat(goalTarget.value),
      start: goalStartDate.value,
      end: goalEndDate.value,
      progress: 0
    };
    if (editingGoalIndex !== null) {
      goals[editingGoalIndex] = newGoal;
    } else {
      goals.push(newGoal);
    }
    localStorage.setItem("goals", JSON.stringify(goals));
    renderGoals();
    closeGoalForm();
  };

  addGoalBtn.onclick = openGoalModal;
  closeGoalModal.onclick = closeGoalForm;

  window.onclick = (event) => {
    if (event.target === document.getElementById("goal-achieved-modal")) {
  document.getElementById("goal-achieved-modal").style.display = "none";
}

    if (event.target === goalModal) closeGoalForm();
  };

  renderGoals();
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'92d57fc7c83f4533',t:'MTc0NDE1NDQ2Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>